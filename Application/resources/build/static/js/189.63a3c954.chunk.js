"use strict";(self.webpackChunkmyapp=self.webpackChunkmyapp||[]).push([[189],{91189:(t,e,r)=>{r.r(e),r.d(e,{default:()=>yt});var n=r(65043),a=r(95010),i=r(22019),o=r(76399),s=r(47419),c=r(11645),l=r(85531),u=r(72968),d=r(10898),p=r(85578),h=r(3188),y=r(96651),f=r(50223),m=r(62058),v=r(90617),g=r(50108),A=r(88420),x=r(56647),b=r(11629),j=r.n(b),S=r(79686),w=r.n(S),k=r(19853),O=r.n(k),P=r(58387),_=r(68471),D=r(68892),E=r(94020),C=r(81519),T=r(38813),N=r(76307),I=r(240),L=r(6015),z=r(20202),B=["type","layout","connectNulls","ref"],F=["key"];function R(t){return R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},R(t)}function W(t,e){if(null==t)return{};var r,n,a=function(t,e){if(null==t)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],e.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function M(){return M=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},M.apply(this,arguments)}function K(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function $(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?K(Object(r),!0).forEach((function(e){Y(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):K(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function U(t){return function(t){if(Array.isArray(t))return J(t)}(t)||function(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"===typeof t)return J(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return J(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function J(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function V(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Z(n.key),n)}}function q(t,e,r){return e=H(e),function(t,e){if(e&&("object"===R(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,G()?Reflect.construct(e,r||[],H(t).constructor):e.apply(t,r))}function G(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(G=function(){return!!t})()}function H(t){return H=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},H(t)}function X(t,e){return X=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},X(t,e)}function Y(t,e,r){return(e=Z(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Z(t){var e=function(t,e){if("object"!=R(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=R(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==R(e)?e:e+""}var Q=function(t){function e(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];return Y(t=q(this,e,[].concat(n)),"state",{isAnimationFinished:!0,totalLength:0}),Y(t,"generateSimpleStrokeDasharray",(function(t,e){return"".concat(e,"px ").concat(t-e,"px")})),Y(t,"getStrokeDasharray",(function(r,n,a){var i=a.reduce((function(t,e){return t+e}));if(!i)return t.generateSimpleStrokeDasharray(n,r);for(var o=Math.floor(r/i),s=r%i,c=n-r,l=[],u=0,d=0;u<a.length;d+=a[u],++u)if(d+a[u]>s){l=[].concat(U(a.slice(0,u)),[s-d]);break}var p=l.length%2===0?[0,c]:[c];return[].concat(U(e.repeat(a,o)),U(l),p).map((function(t){return"".concat(t,"px")})).join(", ")})),Y(t,"id",(0,N.NF)("recharts-line-")),Y(t,"pathRef",(function(e){t.mainCurve=e})),Y(t,"handleAnimationEnd",(function(){t.setState({isAnimationFinished:!0}),t.props.onAnimationEnd&&t.props.onAnimationEnd()})),Y(t,"handleAnimationStart",(function(){t.setState({isAnimationFinished:!1}),t.props.onAnimationStart&&t.props.onAnimationStart()})),t}return function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&X(t,e)}(e,t),r=e,i=[{key:"getDerivedStateFromProps",value:function(t,e){return t.animationId!==e.prevAnimationId?{prevAnimationId:t.animationId,curPoints:t.points,prevPoints:e.curPoints}:t.points!==e.curPoints?{curPoints:t.points}:null}},{key:"repeat",value:function(t,e){for(var r=t.length%2!==0?[].concat(U(t),[0]):t,n=[],a=0;a<e;++a)n=[].concat(U(n),U(r));return n}},{key:"renderDotItem",value:function(t,e){var r;if(n.isValidElement(t))r=n.cloneElement(t,e);else if(j()(t))r=t(e);else{var a=e.key,i=W(e,F),o=(0,P.A)("recharts-line-dot","boolean"!==typeof t?t.className:"");r=n.createElement(D.c,M({key:a},i,{className:o}))}return r}}],(a=[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var t=this.getTotalLength();this.setState({totalLength:t})}}},{key:"componentDidUpdate",value:function(){if(this.props.isAnimationActive){var t=this.getTotalLength();t!==this.state.totalLength&&this.setState({totalLength:t})}}},{key:"getTotalLength",value:function(){var t=this.mainCurve;try{return t&&t.getTotalLength&&t.getTotalLength()||0}catch(e){return 0}}},{key:"renderErrorBar",value:function(t,e){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var r=this.props,a=r.points,i=r.xAxis,o=r.yAxis,s=r.layout,c=r.children,l=(0,I.aS)(c,T.u);if(!l)return null;var u=function(t,e){return{x:t.x,y:t.y,value:t.value,errorVal:(0,z.kr)(t.payload,e)}},d={clipPath:t?"url(#clipPath-".concat(e,")"):null};return n.createElement(E.W,d,l.map((function(t){return n.cloneElement(t,{key:"bar-".concat(t.props.dataKey),data:a,xAxis:i,yAxis:o,layout:s,dataPointFormatter:u})})))}},{key:"renderDots",value:function(t,r,a){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var i=this.props,o=i.dot,s=i.points,c=i.dataKey,l=(0,I.J9)(this.props,!1),u=(0,I.J9)(o,!0),d=s.map((function(t,r){var n=$($($({key:"dot-".concat(r),r:3},l),u),{},{value:t.value,dataKey:c,cx:t.x,cy:t.y,index:r,payload:t.payload});return e.renderDotItem(o,n)})),p={clipPath:t?"url(#clipPath-".concat(r?"":"dots-").concat(a,")"):null};return n.createElement(E.W,M({className:"recharts-line-dots",key:"dots"},p),d)}},{key:"renderCurveStatically",value:function(t,e,r,a){var i=this.props,o=i.type,s=i.layout,c=i.connectNulls,l=(i.ref,W(i,B)),u=$($($({},(0,I.J9)(l,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:e?"url(#clipPath-".concat(r,")"):null,points:t},a),{},{type:o,layout:s,connectNulls:c});return n.createElement(_.I,M({},u,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function(t,e){var r=this,a=this.props,i=a.points,o=a.strokeDasharray,s=a.isAnimationActive,c=a.animationBegin,l=a.animationDuration,u=a.animationEasing,d=a.animationId,p=a.animateNewValues,h=a.width,y=a.height,f=this.state,m=f.prevPoints,v=f.totalLength;return n.createElement(x.Ay,{begin:c,duration:l,isActive:s,easing:u,from:{t:0},to:{t:1},key:"line-".concat(d),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},(function(n){var a=n.t;if(m){var s=m.length/i.length,c=i.map((function(t,e){var r=Math.floor(e*s);if(m[r]){var n=m[r],i=(0,N.Dj)(n.x,t.x),o=(0,N.Dj)(n.y,t.y);return $($({},t),{},{x:i(a),y:o(a)})}if(p){var c=(0,N.Dj)(2*h,t.x),l=(0,N.Dj)(y/2,t.y);return $($({},t),{},{x:c(a),y:l(a)})}return $($({},t),{},{x:t.x,y:t.y})}));return r.renderCurveStatically(c,t,e)}var l,u=(0,N.Dj)(0,v)(a);if(o){var d="".concat(o).split(/[,\s]+/gim).map((function(t){return parseFloat(t)}));l=r.getStrokeDasharray(u,v,d)}else l=r.generateSimpleStrokeDasharray(v,u);return r.renderCurveStatically(i,t,e,{strokeDasharray:l})}))}},{key:"renderCurve",value:function(t,e){var r=this.props,n=r.points,a=r.isAnimationActive,i=this.state,o=i.prevPoints,s=i.totalLength;return a&&n&&n.length&&(!o&&s>0||!O()(o,n))?this.renderCurveWithAnimation(t,e):this.renderCurveStatically(n,t,e)}},{key:"render",value:function(){var t,e=this.props,r=e.hide,a=e.dot,i=e.points,o=e.className,s=e.xAxis,c=e.yAxis,l=e.top,u=e.left,d=e.width,p=e.height,h=e.isAnimationActive,y=e.id;if(r||!i||!i.length)return null;var f=this.state.isAnimationFinished,m=1===i.length,v=(0,P.A)("recharts-line",o),g=s&&s.allowDataOverflow,A=c&&c.allowDataOverflow,x=g||A,b=w()(y)?this.id:y,j=null!==(t=(0,I.J9)(a,!1))&&void 0!==t?t:{r:3,strokeWidth:2},S=j.r,k=void 0===S?3:S,O=j.strokeWidth,_=void 0===O?2:O,D=((0,I.sT)(a)?a:{}).clipDot,T=void 0===D||D,N=2*k+_;return n.createElement(E.W,{className:v},g||A?n.createElement("defs",null,n.createElement("clipPath",{id:"clipPath-".concat(b)},n.createElement("rect",{x:g?u:u-d/2,y:A?l:l-p/2,width:g?d:2*d,height:A?p:2*p})),!T&&n.createElement("clipPath",{id:"clipPath-dots-".concat(b)},n.createElement("rect",{x:u-N/2,y:l-N/2,width:d+N,height:p+N}))):null,!m&&this.renderCurve(x,b),this.renderErrorBar(x,b),(m||a)&&this.renderDots(x,T,b),(!h||f)&&C.Z.renderCallByParent(this.props,i))}}])&&V(r.prototype,a),i&&V(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,a,i}(n.PureComponent);Y(Q,"displayName","Line"),Y(Q,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!L.m.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1}),Y(Q,"getComposedData",(function(t){var e=t.props,r=t.xAxis,n=t.yAxis,a=t.xAxisTicks,i=t.yAxisTicks,o=t.dataKey,s=t.bandSize,c=t.displayedData,l=t.offset,u=e.layout;return $({points:c.map((function(t,e){var c=(0,z.kr)(t,o);return"horizontal"===u?{x:(0,z.nb)({axis:r,ticks:a,bandSize:s,entry:t,index:e}),y:w()(c)?null:n.scale(c),value:c,payload:t}:{x:w()(c)?null:r.scale(c),y:(0,z.nb)({axis:n,ticks:i,bandSize:s,entry:t,index:e}),value:c,payload:t}})),layout:u},l)}));var tt=r(52185),et=r(6026),rt=r(3831),nt=(0,A.gu)({chartName:"LineChart",GraphicalChild:Q,axisComponents:[{axisType:"xAxis",AxisComp:tt.W},{axisType:"yAxis",AxisComp:et.h}],formatAxisMap:rt.pr}),at=r(87734),it=r(86150),ot=r(33355),st=r(70579);const{Title:ct}=ot.A;function lt(t){let{dailyActivity:e}=t;const[r,a]=(0,n.useState)([]);return(0,n.useEffect)((()=>{const t=Object.entries(e||{}).map((t=>{let[e,r]=t;return{date:new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric"}),count:r}})).reverse();a(t)}),[e]),(0,st.jsxs)(l.A,{style:{marginTop:16,marginBottom:16,padding:"2%"},children:[(0,st.jsx)(ct,{level:4,style:{marginBottom:24},children:"Activity Trend (Last 7 Days)"}),(0,st.jsx)("div",{style:{width:"100%",height:300},children:(0,st.jsx)(g.u,{children:(0,st.jsxs)(nt,{data:r,margin:{top:5,right:30,left:20,bottom:5},children:[(0,st.jsx)(at.d,{strokeDasharray:"3 3"}),(0,st.jsx)(tt.W,{dataKey:"date",tick:{fill:"#666"}}),(0,st.jsx)(et.h,{tick:{fill:"#666"},allowDecimals:!1}),(0,st.jsx)(it.m,{contentStyle:{backgroundColor:"white",border:"1px solid #ccc",borderRadius:"4px"}}),(0,st.jsx)(Q,{type:"monotone",dataKey:"count",stroke:"#4E71CF",strokeWidth:2,dot:{fill:"#4E71CF",r:4},activeDot:{r:6},name:"Activities"})]})})})]})}var ut=r(94505),dt=r(52967);const pt="activity_CardDetails__hXHzJ",{Option:ht}=a.A,yt=()=>{var t;const[e,r]=(0,n.useState)(!1),[g,A]=(0,n.useState)(!1),[x,b]=(0,n.useState)([]),[j,S]=(0,n.useState)([]),[w,k]=(0,n.useState)({total_logs:0,logs_today:0,logs_this_week:0,most_common_action:null,daily_activity:{}}),O=(0,n.useRef)({current:1,pageSize:15,total:0}),P=(0,n.useRef)({action:void 0,username:void 0,date_from:void 0,date_to:void 0}),_=(0,n.useCallback)((async function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r(!0);try{const e=await ut.Ay.get("/activity-logs",{params:{...P.current,page:t.current||O.current.current,per_page:t.pageSize||O.current.pageSize,sort_by:t.sortField||"created_at",sort_direction:"ascend"===t.sortOrder?"asc":"desc"}});e.data&&(b(e.data.data||[]),O.current={...O.current,current:Number(e.data.current_page)||1,total:Number(e.data.total)||0})}catch(e){console.error("Error fetching activity logs:",e),i.Ay.error("Failed to fetch activity logs")}finally{r(!1)}}),[]),D=async()=>{A(!0);try{const t=await ut.Ay.get("/activity-logs/statistics");t.data&&k(t.data)}catch(t){console.error("Error fetching statistics:",t),i.Ay.error("Failed to fetch statistics")}finally{A(!1)}};(0,n.useEffect)((()=>{(async()=>{try{const[t]=await Promise.all([ut.Ay.get("/activity-logs/action-types"),_(),D()]);S(t.data||[])}catch(t){console.error("Error fetching initial data:",t),i.Ay.error("Failed to fetch initial data")}})()}),[_]);const E=(0,n.useCallback)(((t,e)=>{P.current={...P.current,[t]:e},O.current.current=1,_({current:1,pageSize:O.current.pageSize})}),[_]),C=[{title:"Username",dataIndex:"username",sorter:!0,width:"15%"},{title:"Action",dataIndex:"action",sorter:!0,width:"15%",render:t=>(0,st.jsx)(o.A,{color:"INSERT"===t?"green":"UPDATE"===t?"blue":"DELETE"===t?"red":"default",children:t})},{title:"Description",dataIndex:"actionDesc",width:"40%"},{title:"Date",dataIndex:"created_at",sorter:!0,width:"20%",render:t=>new Date(t).toLocaleString()}];return(0,st.jsxs)("div",{style:{padding:24},children:[(0,st.jsxs)(s.A,{gutter:[16,16],children:[(0,st.jsx)(c.A,{xs:24,sm:12,md:6,children:(0,st.jsx)(l.A,{loading:g,className:pt,children:(0,st.jsx)(u.A,{title:"Total Logs",value:w.total_logs})})}),(0,st.jsx)(c.A,{xs:24,sm:12,md:6,children:(0,st.jsx)(l.A,{loading:g,className:pt,children:(0,st.jsx)(u.A,{title:"Logs Today",value:w.logs_today})})}),(0,st.jsx)(c.A,{xs:24,sm:12,md:6,children:(0,st.jsx)(l.A,{loading:g,className:pt,children:(0,st.jsx)(u.A,{title:"Logs This Week",value:w.logs_this_week})})}),(0,st.jsx)(c.A,{xs:24,sm:12,md:6,children:(0,st.jsx)(l.A,{loading:g,className:pt,children:(0,st.jsx)(u.A,{title:"Most Common Action",value:(null===(t=w.most_common_action)||void 0===t?void 0:t.action)||"N/A",suffix:w.most_common_action?`(${w.most_common_action.count})`:""})})})]}),(0,st.jsx)(c.A,{xs:24,sm:24,md:24,children:(0,st.jsx)(lt,{dailyActivity:w.daily_activity})}),(0,st.jsxs)(l.A,{style:{marginTop:16,padding:"1%"},children:[(0,st.jsxs)(d.A,{style:{marginBottom:16},wrap:!0,children:[(0,st.jsx)(a.A,{style:{width:200},placeholder:"Select Action",allowClear:!0,onChange:t=>E("action",t),children:j.map((t=>(0,st.jsx)(ht,{value:t,children:t},t)))}),(0,st.jsx)(p.A.Search,{style:{width:300},placeholder:"Search by username",allowClear:!0,enterButton:(0,st.jsx)(h.Ay,{icon:(0,st.jsx)(m.A,{}),type:"primary",children:"Search"}),onSearch:t=>E("username",t)}),(0,st.jsx)(y.A,{title:"Refresh",children:(0,st.jsx)(h.Ay,{icon:(0,st.jsx)(v.A,{}),onClick:()=>{_({current:1}),D()},className:dt.A.ActionButton})})]}),(0,st.jsx)(f.A,{columns:C,dataSource:x,rowKey:"log_id",pagination:{...O.current,showSizeChanger:!0,pageSizeOptions:["10","15","25","50","100"],showTotal:(t,e)=>`${e[0]}-${e[1]} of ${t} items`},loading:e,onChange:(t,e,r)=>{O.current={...O.current,current:t.current,pageSize:t.pageSize},_({current:t.current,pageSize:t.pageSize,sortField:r.field,sortOrder:r.order})},scroll:{x:"max-content"}})]})]})}},94505:(t,e,r)=>{r.d(e,{Ay:()=>o});var n=r(86213);const a=n.A.create({baseURL:"https://mcws.mooo.com/api",withCredentials:!0,headers:{Accept:"application/json","Content-Type":"application/json"}});a.interceptors.request.use((t=>{const e=localStorage.getItem("token");return e&&(t.headers.Authorization=`Bearer ${e}`),t}),(t=>Promise.reject(t))),a.interceptors.response.use((t=>t),(t=>(t.response&&401===t.response.status&&(localStorage.removeItem("token"),window.location="/login"),Promise.reject(t))));const i=localStorage.getItem("token");i&&(n.A.defaults.headers.common.Authorization=`Bearer ${i}`);const o=a},90617:(t,e,r)=>{r.d(e,{A:()=>c});var n=r(58168),a=r(65043);const i={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M909.1 209.3l-56.4 44.1C775.8 155.1 656.2 92 521.9 92 290 92 102.3 279.5 102 511.5 101.7 743.7 289.8 932 521.9 932c181.3 0 335.8-115 394.6-276.1 1.5-4.2-.7-8.9-4.9-10.3l-56.7-19.5a8 8 0 00-10.1 4.8c-1.8 5-3.8 10-5.9 14.9-17.3 41-42.1 77.8-73.7 109.4A344.77 344.77 0 01655.9 829c-42.3 17.9-87.4 27-133.8 27-46.5 0-91.5-9.1-133.8-27A341.5 341.5 0 01279 755.2a342.16 342.16 0 01-73.7-109.4c-17.9-42.4-27-87.4-27-133.9s9.1-91.5 27-133.9c17.3-41 42.1-77.8 73.7-109.4 31.6-31.6 68.4-56.4 109.3-73.8 42.3-17.9 87.4-27 133.8-27 46.5 0 91.5 9.1 133.8 27a341.5 341.5 0 01109.3 73.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.6 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c-.1-6.6-7.8-10.3-13-6.2z"}}]},name:"reload",theme:"outlined"};var o=r(51835),s=function(t,e){return a.createElement(o.A,(0,n.A)({},t,{ref:e,icon:i}))};const c=a.forwardRef(s)},52967:(t,e,r)=>{r.d(e,{A:()=>n});const n={"fade-in":"App_fade-in__8IP91",show:"App_show__YgTh4",ActionButton:"App_ActionButton__SVqGL",DeleteButton:"App_DeleteButton__ffM0l"}}}]);
//# sourceMappingURL=189.63a3c954.chunk.js.map